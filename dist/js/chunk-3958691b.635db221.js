(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3958691b"],{"669d":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"profile"},[n("van-nav-bar",{attrs:{"left-arrow":"",title:"编辑资料"},on:{"click-left":function(t){return e.$router.back()}}}),n("van-cell-group",[n("input",{ref:"refPhoto",attrs:{type:"file",hidden:""},on:{change:e.updatePhoto}}),n("van-cell",{attrs:{"is-link":"",title:"头像",center:""},on:{click:function(t){return e.$refs.refPhoto.click()}}},[n("van-image",{attrs:{slot:"default",width:"1.5rem",height:"1.5rem",fit:"cover",round:"",src:e.user.photo},slot:"default"})],1),n("van-cell",{attrs:{"is-link":"",title:"名称",value:e.user.name},on:{click:e.clickShowName}}),n("van-cell",{attrs:{"is-link":"",title:"性别",value:0===e.user.gender?"男":"女"},on:{click:function(t){e.showGender=!0}}}),n("van-cell",{attrs:{"is-link":"",title:"生日",value:e.user.birthday},on:{click:e.clickShowBirthday}})],1),n("van-dialog",{attrs:{title:"修改昵称","show-cancel-button":""},on:{confirm:e.saveName},model:{value:e.showName,callback:function(t){e.showName=t},expression:"showName"}},[n("van-field",{attrs:{placeholder:"请输入昵称"},model:{value:e.newName,callback:function(t){e.newName="string"===typeof t?t.trim():t},expression:"newName"}})],1),n("van-popup",{attrs:{position:"bottom"},model:{value:e.showGender,callback:function(t){e.showGender=t},expression:"showGender"}},[n("van-nav-bar",{attrs:{title:"修改性别","left-text":"取消"},on:{"click-left":function(t){e.showGender=!1}}}),n("van-cell",{attrs:{title:"男","is-link":""},on:{click:function(t){return e.saveGender(0)}}}),n("van-cell",{attrs:{title:"女","is-link":""},on:{click:function(t){return e.saveGender(1)}}})],1),n("van-popup",{attrs:{position:"bottom"},model:{value:e.showBirthday,callback:function(t){e.showBirthday=t},expression:"showBirthday"}},[n("van-datetime-picker",{attrs:{type:"date",title:"选择生日","min-date":e.minDate,"max-date":e.maxDate},on:{cancel:function(t){e.showBirthday=!1},confirm:e.saveBirthday},model:{value:e.newDate,callback:function(t){e.newDate=t},expression:"newDate"}})],1)],1)},r=[],s=(n("b0c0"),n("96cf"),n("1da1")),i=n("c24f"),o=n("5a0c"),c=n.n(o),u={name:"userProfile",data:function(){return{showName:!1,showGender:!1,showBirthday:!1,user:{},newName:"",minDate:new Date(1900,1,1),maxDate:new Date,newDate:new Date}},created:function(){this.loadUserProfile()},methods:{loadUserProfile:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["b"])();case 2:n=t.sent,e.user=n.data.data;case 5:case"end":return t.stop()}}),t)})))()},clickShowName:function(){this.showName=!0,this.newName=this.user.name},saveName:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,""!==e.newName){t.next=3;break}return t.abrupt("return");case 3:if(!(e.newName.length>7)){t.next=6;break}return e.$toast.fail("用户名长度不能超过7位字符"),t.abrupt("return");case 6:return t.next=8,Object(i["g"])({name:e.newName});case 8:e.user.name=e.newName,e.$toast.success("修改成功"),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),e.$toast.fail("用户名已存在, 请重新编辑");case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()},saveGender:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(i["g"])({gender:e});case 3:t.user.gender=e,t.showGender=!1,t.$toast.success("修改成功"),n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](0),t.$toast.fail("修改失败");case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))()},clickShowBirthday:function(){this.showBirthday=!0,this.newDate=new Date(this.user.birthday)},saveBirthday:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=c()(e.newDate).format("YYYY-MM-DD"),t.next=4,Object(i["g"])({birthday:n});case 4:e.user.birthday=n,e.showBirthday=!1,e.$toast.success("修改成功"),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),e.$toast.fail("修改失败");case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},updatePhoto:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.$toast.loading({duration:0,overlay:!0,message:"正在上传中..."}),n=e.$refs.refPhoto.files[0],a=new FormData,a.append("photo",n),t.next=7,Object(i["f"])(a);case 7:r=t.sent,e.user.photo=r.data.data.photo,e.$toast.success("上传成功"),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),e.$toast.fail("上传失败");case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()}}},l=u,h=(n("b0a5"),n("2877")),f=Object(h["a"])(l,a,r,!1,null,"373f3e9e",null);t["default"]=f.exports},8942:function(e,t,n){},b0a5:function(e,t,n){"use strict";n("8942")}}]);
//# sourceMappingURL=chunk-3958691b.635db221.js.map