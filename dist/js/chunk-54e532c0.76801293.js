(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-54e532c0"],{"1fbf":function(t,e,n){"use strict";n("fc2d")},2103:function(t,e,n){},"230c":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"article-container"},[n("van-nav-bar",{attrs:{fixed:"","left-arrow":"",title:"文章详情"},on:{"click-left":function(e){return t.$router.back()}}}),t.loading?n("van-loading",{staticClass:"article-loading"}):n("div",[n("div",{staticClass:"detail"},[n("h3",{staticClass:"title"},[t._v(t._s(t.article.title))]),n("div",{staticClass:"author"},[n("van-image",{attrs:{src:t.article.aut_photo,round:"",width:"1rem",height:"1rem",fit:"fill"}}),n("div",{staticClass:"text"},[n("p",{staticClass:"name"},[t._v(t._s(t.article.aut_name))]),n("p",{staticClass:"time"},[t._v(t._s(t._f("relative")(t.article.pubdate)))])]),n("van-button",{attrs:{round:"",size:"small",type:"info"},on:{click:t.toggleFollow}},[t._v(t._s(t.article.is_followed?"取关":"+ 关注"))])],1),n("div",{staticClass:"content",domProps:{innerHTML:t._s(t.article.content)}}),n("van-divider",[t._v("END")]),n("div",{staticClass:"zan"},[n("van-button",{attrs:{round:"",size:"small",hairline:"",type:"primary",plain:"",icon:1===t.article.attitude?"good-job":"good-job-o"},on:{click:t.toggleLike}},[t._v(" "+t._s(1===t.article.attitude?"取消点赞":"点赞")+" ")]),t._v(" "),n("van-button",{attrs:{round:"",size:"small",hairline:"",type:"danger",plain:"",icon:"delete"},on:{click:t.toggleDislike}},[t._v(" "+t._s(0===t.article.attitude?"取消不喜欢":"不喜欢")+" ")])],1)],1),n("article-comment",{attrs:{"article-id":t.$route.params.id}})],1)],1)},i=[],r=(n("d3b7"),n("25f0"),n("96cf"),n("1da1")),c=n("2423"),s=n("c24f"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"article-comments"},[n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return n("van-cell",{key:e.com_id.toString()},[n("van-image",{staticStyle:{"margin-right":"10px"},attrs:{slot:"icon",round:"",width:"30",height:"30",src:e.aut_photo},slot:"icon"}),n("span",{staticStyle:{color:"#466b9d"},attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.aut_name))]),n("div",{attrs:{slot:"label"},slot:"label"},[n("p",{staticStyle:{color:"#363636"}},[t._v(t._s(e.content))]),n("p",[n("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t._f("relative")(e.pubdate)))]),n("van-button",{attrs:{size:"mini",type:"default"},on:{click:function(n){return t.clickShowReply(e)}}},[t._v("回复")])],1)]),n("van-icon",{attrs:{slot:"right-icon",name:e.is_liking?"like":"like-o"},slot:"right-icon"})],1)})),1),n("van-cell-group",{staticClass:"publish-wrap"},[n("van-field",{attrs:{clearable:"",placeholder:"请输入评论内容"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}},[n("van-button",{attrs:{slot:"button",size:"mini",type:"info"},on:{click:t.addComment},slot:"button"},[t._v("发布")])],1)],1),n("van-popup",{style:{height:"80%"},attrs:{position:"bottom",round:""},model:{value:t.isShowReply,callback:function(e){t.isShowReply=e},expression:"isShowReply"}},[t.isShowReply?n("comment-reply",{attrs:{"article-id":t.articleId,comment:t.currentComment},on:{close:function(e){t.isShowReply=!1}}}):t._e()],1)],1)},l=[],u=(n("99af"),n("498a"),n("2909")),d=n("b775"),p=function(t,e){return Object(d["a"])({method:"post",url:"/app/v1_0/comments",data:{target:t,content:e}})},m=function(t,e){return Object(d["a"])({method:"get",url:"/app/v1_0/comments",params:{type:"a",source:t,offset:e}})},f=function(t,e,n){return Object(d["a"])({method:"post",url:"/app/v1_0/comments",data:{target:t,content:e,art_id:n}})},v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"article-comments"},[n("van-nav-bar",{attrs:{title:t.comment.reply_count+"条回复"}},[n("van-icon",{attrs:{slot:"left",name:"cross"},on:{click:function(e){return t.$emit("close")}},slot:"left"})],1),n("van-cell",{attrs:{title:"当前评论"}},[n("van-image",{staticStyle:{"margin-right":"10px"},attrs:{slot:"icon",round:"",width:"30",height:"30",src:t.comment.aut_photo},slot:"icon"}),n("span",{staticStyle:{color:"#466b9d"},attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.comment.aut_name))]),n("div",{attrs:{slot:"label"},slot:"label"},[n("p",{staticStyle:{color:"#363636"}},[t._v(t._s(t.comment.content))]),n("p",[n("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t._f("relative")(t.comment.pubdate)))]),n("van-button",{attrs:{size:"mini",type:"default"}},[t._v("回复 "+t._s(t.comment.reply_count))])],1)]),n("van-icon",{attrs:{slot:"right-icon"},slot:"right-icon"})],1),n("van-divider",[t._v("全部回复")]),n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e,a){return n("van-cell",{key:a},[n("van-image",{staticStyle:{"margin-right":"10px"},attrs:{slot:"icon",round:"",width:"30",height:"30",src:e.aut_photo},slot:"icon"}),n("span",{staticStyle:{color:"#466b9d"},attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.aut_name))]),n("div",{attrs:{slot:"label"},slot:"label"},[n("p",{staticStyle:{color:"#363636"}},[t._v(t._s(e.content))]),n("p",[n("span",{staticStyle:{"margin-right":"10px"}},[t._v("时间: "+t._s(t._f("relative")(e.pubdate)))])])])],1)})),1),n("van-cell-group",{staticClass:"publish-wrap"},[n("van-field",{attrs:{clearable:"",placeholder:"请输入回复内容"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}},[n("van-button",{attrs:{slot:"button",size:"mini",type:"info"},on:{click:t.clickAddReply},slot:"button"},[t._v("发布")])],1)],1)],1)},h=[],b={name:"CommentReply",props:{comment:{type:Object,required:!0},articleId:{type:String,required:!0}},data:function(){return{list:[],loading:!1,finished:!1,offset:null,content:""}},methods:{onLoad:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:try{t.finished=!0}catch(n){}case 2:case"end":return e.stop()}}),e)})))()},clickAddReply:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.comment.com_id.toString(),e.next=3,f(n,t.content,t.articleId);case 3:a=e.sent,t.list.unshift(a.data.data.new_obj),t.$toast.success("添加回复成功"),t.content="";case 7:case"end":return e.stop()}}),e)})))()}}},g=b,_=(n("3f4c"),n("2877")),w=Object(_["a"])(g,v,h,!1,null,"3c66119e",null),k=w.exports,x={name:"ArticleComment",components:{CommentReply:k},props:{articleId:{type:String,required:!0}},data:function(){return{list:[],loading:!1,finished:!1,content:"",offset:null,isShowReply:!1,currentComment:{}}},methods:{onLoad:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m(t.articleId,t.offset);case 3:n=e.sent,a=n.data.data.results,t.list=[].concat(Object(u["a"])(t.list),Object(u["a"])(a)),t.offset=n.data.data.last_id,t.loading=!1,0===a.length&&(t.finished=!0),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))()},addComment:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!==t.content.trim()){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,p(t.articleId,t.content);case 5:n=e.sent,t.$toast.success("评论成功"),t.list.unshift(n.data.data.new_obj),t.content="",e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](2),t.$toast.fail("操作失败, 评论已关闭");case 15:case"end":return e.stop()}}),e,null,[[2,11]])})))()},clickShowReply:function(t){this.isShowReply=!0,this.currentComment=t}}},y=x,R=(n("49f0"),Object(_["a"])(y,o,l,!1,null,"e85843b2",null)),S=R.exports,j={name:"ArticleIndex",data:function(){return{loading:!0,article:{}}},components:{ArticleComment:S},created:function(){this.loadArticle()},methods:{loadArticle:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["f"])(t.$route.params.id);case 2:n=e.sent,t.article=n.data.data,t.loading=!1;case 6:case"end":return e.stop()}}),e)})))()},toggleFollow:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!t.article.is_followed){e.next=7;break}return e.next=4,Object(s["e"])(t.article.aut_id);case 4:t.$toast.success("取关成功"),e.next=10;break;case 7:return e.next=9,Object(s["a"])(t.article.aut_id);case 9:t.$toast.success("关注成功");case 10:t.article.is_followed=!t.article.is_followed,e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](0),t.$toast.fail("操作失败");case 17:case"end":return e.stop()}}),e,null,[[0,13]])})))()},toggleLike:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,1!==t.article.attitude){e.next=8;break}return e.next=4,Object(c["d"])(t.article.art_id.toString());case 4:t.$toast.success("取消点赞成功"),t.article.attitude=-1,e.next=12;break;case 8:return e.next=10,Object(c["b"])(t.article.art_id.toString());case 10:t.$toast.success("点赞成功"),t.article.attitude=1;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](0),t.$toast.fail("操作失败");case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))()},toggleDislike:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,0!==t.article.attitude){e.next=8;break}return e.next=4,Object(c["c"])(t.article.art_id.toString());case 4:t.$toast.success("取消不喜欢"),t.article.attitude=-1,e.next=12;break;case 8:return e.next=10,Object(c["a"])(t.article.art_id.toString());case 10:t.$toast.success("操作成功"),t.article.attitude=0;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](0),t.$toast.fail("操作失败");case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))()}}},O=j,C=(n("1fbf"),Object(_["a"])(O,a,i,!1,null,"46a62176",null));e["default"]=C.exports},"3f4c":function(t,e,n){"use strict";n("4c67")},"49f0":function(t,e,n){"use strict";n("2103")},"4c67":function(t,e,n){},fc2d:function(t,e,n){}}]);
//# sourceMappingURL=chunk-54e532c0.76801293.js.map